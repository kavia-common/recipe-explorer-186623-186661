---
interface Props {
  id?: string;
  placeholder?: string;
  value?: string;
}
const { id = 'search', placeholder = 'Search...', value = '' } = Astro.props as Props;
---

<div class="search-wrap">
  <label class="visually-hidden" for={id}>Search recipes</label>
  <input
    id={id}
    class="input"
    type="search"
    name="q"
    placeholder={placeholder}
    value={value}
    autocomplete="off"
    inputmode="search"
    aria-label="Search recipes"
  />
</div>

<style>
  .search-wrap {
    position: relative;
  }
  .visually-hidden {
    position: absolute !important;
    width: 1px; height: 1px;
    margin: -1px; padding: 0; border: 0;
    clip: rect(0 0 0 0);
    overflow: hidden;
  }
  .search-wrap::before {
    content: "ðŸ”Ž";
    position: absolute;
    left: 12px; top: 50%; transform: translateY(-50%);
    opacity: .7;
    pointer-events: none;
  }
  input.input {
    padding-left: 2.25rem;
  }
</style>

<script>
  const root = document.currentScript?.closest('.search-wrap');
  const input = root?.querySelector('input');
  if (input) {
    input.addEventListener('input', (e) => {
      const term = (e.target as HTMLInputElement).value;
      window.dispatchEvent(new CustomEvent('recipes:search', { detail: { term } }));
    });
  }
</script>
