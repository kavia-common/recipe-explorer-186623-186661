---
import Tag from './Tag.astro';
import Rating from './Rating.astro';

interface Recipe {
  id: string;
  title: string;
  description: string;
  image?: string;
  tags?: string[];
  rating?: number;
  time?: string;
}

const { recipe } = Astro.props as { recipe: Recipe };
const img = recipe.image ?? 'https://images.unsplash.com/photo-1512621776951-a57141f2eefd?auto=format&fit=crop&w=1200&q=60';
---

<a class="card recipe-card" href={`/recipes/${recipe.id}`} aria-label={`Open ${recipe.title}`}>
  <div class="thumb">
    <img src={img} alt={recipe.title} width="600" height="400" loading="lazy" />
    {recipe.time && <span class="badge">‚è± {recipe.time}</span>}
  </div>
  <div class="body">
    <div class="title-row">
      <h3 class="title">{recipe.title}</h3>
      <Rating value={recipe.rating ?? 0} />
    </div>
    <p class="desc">{recipe.description}</p>
    {recipe.tags && recipe.tags.length > 0 && (
      <div class="tags">
        {recipe.tags.map((t) => <Tag label={t} />)}
      </div>
    )}
  </div>
</a>

<style>
  .recipe-card {
    display: grid;
    grid-template-rows: auto 1fr;
    text-decoration: none;
    color: inherit;
    overflow: hidden;
  }
  .thumb {
    position: relative;
    aspect-ratio: 16/10;
    overflow: hidden;
  }
  .thumb img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
    transition: transform .3s ease;
  }
  .recipe-card:hover .thumb img {
    transform: scale(1.03);
  }
  .badge {
    position: absolute;
    left: .75rem; bottom: .75rem;
    background: rgba(17,24,39,0.6);
    color: white;
    padding: .25rem .5rem;
    border-radius: 999px;
    font-size: .8rem;
    border: 1px solid rgba(255,255,255,0.2);
    backdrop-filter: blur(4px);
  }
  .body {
    padding: .85rem .9rem 1rem;
    display: grid;
    gap: .5rem;
  }
  .title-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: .75rem;
  }
  .title {
    font-size: 1.05rem;
    margin: 0;
  }
  .desc {
    margin: 0;
    color: #4b5563;
    font-size: .95rem;
    line-height: 1.35;
  }
  .tags {
    display: flex; flex-wrap: wrap; gap: .35rem;
    margin-top: .25rem;
  }
</style>
